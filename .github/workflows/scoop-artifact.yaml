name: Build Scoop Artifact
run-name: ${{ github.actor }} Build Scoop.sh artifact.
on: push
jobs:
  setup:
    runs-on: windows-latest
    permissions:
      contents: read
    defaults:
      run:
        shell: pwsh
    steps:
      - uses: actions/checkout@v3
      - name: Scoop setup
        run: |
          Set-ExecutionPolicy -ExecutionPolicy RemoteSigned
          Invoke-RestMethod get.scoop.sh -outfile 'install.ps1'
          ./install.ps1 -RunAsAdmin
          scoop update
          New-Item -Path 'artifact' -ItemType Directory
          $scoop_zip = "artifact\scoop.zip" + $scoopConfig.artifact_ver + ".zip"
          $scoop_path = $HOME + "\scoop"
          Compress-Archive -Path $scoop_path -D -D $scoop_zip
      - name: Upload artifact.
        uses: actions/upload-artifact@v3
        with:
          name: Scoop Artifact
          path: artifact\*